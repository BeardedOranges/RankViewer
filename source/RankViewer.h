#pragma once
#pragma comment( lib, "bakkesmod.lib" )
#include "bakkesmod/plugin/bakkesmodplugin.h"

class RankViewer : public BakkesMod::Plugin::BakkesModPlugin
{
private:
	SteamID mySteamID;
	bool drawCanvas, isEnabled, gotNewMMR, isPlacement;
	int userPlaylist, userDiv, userTier, upperTier, lowerTier, upperDiv, lowerDiv, nextLower, beforeUpper;
	float userMMR;
	string nameCurrent, nameNext, nameBefore, nextDiff, beforeDiff;
public:
	virtual void onLoad();
	virtual void onUnload();
	
	void Render(CanvasWrapper canvas);
	void StatsScreen(std::string eventName);
	void loadMenu(std::string eventName);
	void CheckMMR(int retryCount);
};


//MODES
enum MODES
{
	MODE_Ones = 10,
	MODE_Twos = 11,
	MODE_Solo = 12,
	MODE_Threes = 13,
	MODE_Hoops = 27,
	MODE_Rumble = 28,
	MODE_Dropshot = 29,
	MODE_Snowday = 30,
};

//RANK NAME ARRAYS
enum RANKS
{
    RANK_Unranked = 0,
    RANK_Bronze_1 = 1,
    RANK_Bronze_2 = 2,
    RANK_Bronze_3 = 3,
    RANK_Silver_1 = 4,
    RANK_Silver_2 = 5,
    RANK_Silver_3 = 6,
    RANK_Gold_1 = 7,
    RANK_Gold_2 = 8,
    RANK_Gold_3 = 9,
    RANK_Platinum_1 = 10,
    RANK_Platinum_2 = 11,
    RANK_Platinum_3 = 12,
    RANK_Diamond_1 = 13,
    RANK_Diamond_2 = 14,
    RANK_Diamond_3 = 15,
    RANK_Champion_1 = 16,
    RANK_Champion_2 = 17,
    RANK_Champion_3 = 18,
    RANK_Grand_Champion = 19,
};
string rankNames[] =
{
    "Unranked",
    "Bronze 1",
    "Bronze 2",
    "Bronze 3",
    "Silver 1",
    "Silver 2",
    "Silver 3",
    "Gold 1",
    "Gold 2",
    "Gold 3",
    "Platinum 1",
    "Platinum 2",
    "Platinum 3",
    "Diamond 1",
    "Diamond 2",
    "Diamond 3",
    "Champion 1",
    "Champion 2",
    "Champion 3",
    "Grand Champion"
};
enum DIVS
{
	DIV_1 = 0,
	DIV_2 = 1,
	DIV_3 = 2,
	DIV_4 = 3,
};
string divNames[] =
{
    " Div 1",
    " Div 2",
    " Div 3",
    " Div 4"
};

//COLORS
LinearColor schemes[20] =
{
    { 133, 133, 133, 255 },	//  0 | Unranked
    { 227, 151, 68, 255 },	//  1 | Bronze 1
    { 227, 151, 68, 255 },	//  2 | Bronze 2
    { 227, 151, 68, 255 },	//  3 | Bronze 3
    { 133, 133, 133, 255 },	//  4 | Silver 1
    { 133, 133, 133, 255 },	//  5 | Silver 2
    { 133, 133, 133, 255 },	//  6 | Silver 3
    { 202, 149, 31, 255 },	//  7 | Gold 1
    { 202, 149, 31, 255 },	//  8 | Gold 2
    { 202, 149, 31, 255 },	//  9 | Gold 3
    { 50, 204, 252, 255 },	// 10 | Platinum 1
    { 50, 204, 252, 255 },	// 11 | Platinum 2
    { 50, 204, 252, 255 },	// 12 | Platinum 3
    { 2, 188, 255, 255 },	// 13 | Diamond 1
    { 2, 188, 255, 255 },	// 14 | Diamond 2
    { 2, 188, 255, 255 },	// 15 | Diamond 3
    { 202, 137, 255, 255 },	// 16 | Champion 1
    { 202, 137, 255, 255 },	// 17 | Champion 2
    { 202, 137, 255, 255 },	// 18 | Champion 3
    { 244, 56, 236, 255 }	// 19 | Grand Champion
};

//RANK RANGES
// [Rank descending (Grand Champ, Champ 3, Champ 2, etc)][Divisions descending (IV, III, II, I)][MMR Range ascending (lower limit, upper limit)]
const int ones[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1223, 1325},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1212, 1225},	{1188, 1206},	{1164, 1183},	{1155, 1163}},	// Champ 3
	{{1132, 1142},	{1108, 1123},	{1085, 1107},	{1074, 1083}},	// Champ 2
	{{1052, 1060},	{1028, 1048},	{1005, 1025},	{995, 1003}},	// Champ 1
	{{977, 985},	{958, 976},		{939, 957},		{929, 938}},	// Diamond 3
	{{917, 925},	{898, 916},		{879, 897},		{872, 878}},	// Diamond 2
	{{857, 865},	{838, 856},		{819, 837},		{814, 818}},	// Diamond 1
	{{797, 805},	{778, 796},		{759, 777},		{747, 758}},	// Platinum 3
	{{737, 745},	{718, 736},		{699, 717},		{692, 698}},	// Platinum 2
	{{677, 684},	{658, 676},		{639, 657},		{633, 638}},	// Platinum 1
	{{617, 624},	{598, 616},		{579, 597},		{571, 578}},	// Gold 3
	{{557, 564},	{538, 556},		{519, 537},		{513, 518}},	// Gold 2
	{{497, 505},	{478, 496},		{459, 477},		{453, 458}},	// Gold 1
	{{437, 445},	{418, 436},		{399, 417},		{392, 398}},	// Silver 3
	{{377, 384},	{358, 376},		{339, 357},		{332, 338}},	// Silver 2
	{{317, 322},	{298, 316},		{279, 297},		{273, 278}},	// Silver 1
	{{257, 265},	{238, 256},		{219, 237},		{212, 218}},	// Bronze 3
	{{197, 200},	{178, 196},		{159, 177},		{148, 158}},	// Bronze 2
	{{142, 153},	{128, 140},		{114, 127},		{0, 113}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int twos[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1500, 1708},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1482, 1500},	{1448, 1466},	{1415, 1436},	{1395, 1413}},	// Champ 3
	{{1367, 1380},	{1338, 1365},	{1312, 1337},	{1295, 1308}},	// Champ 2
	{{1267, 1280},	{1238, 1265},	{1210, 1237},	{1195, 1208}},	// Champ 1
	{{1167, 1180},	{1138, 1165},	{1110, 1137},	{1094, 1108}},	// Diamond 3
	{{1072, 1080},	{1048, 1071},	{1024, 1047},	{1013, 1023}},	// Diamond 2
	{{992, 1000},	{968, 991},		{944, 967},		{933, 943}},	// Diamond 1
	{{912, 920},	{888, 911},		{864, 887},		{852, 863}},	// Platinum 3
	{{832, 840},	{808, 831},		{784, 807},		{773, 783}},	// Platinum 2
	{{752, 760},	{728, 751},		{704, 727},		{693, 703}},	// Platinum 1
	{{672, 680},	{648, 671},		{624, 647},		{612, 623}},	// Gold 3
	{{597, 605},	{578, 596},		{559, 577},		{549, 558}},	// Gold 2
	{{537, 545},	{518, 536},		{499, 517},		{489, 498}},	// Gold 1
	{{477, 485},	{458, 476},		{439, 457},		{429, 438}},	// Silver 3
	{{417, 424},	{398, 416},		{379, 397},		{368, 378}},	// Silver 2
	{{357, 365},	{338, 356},		{319, 337},		{310, 318}},	// Silver 1
	{{297, 305},	{278, 296},		{259, 277},		{250, 258}},	// Bronze 3
	{{237, 242},	{218, 236},		{199, 217},		{190, 198}},	// Bronze 2
	{{172, 180},	{148, 171},		{125, 147},		{0, 123}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int threes[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1501, 1710},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1482, 1500},	{1448, 1466},	{1415, 1434},	{1395, 1413}},	// Champ 3
	{{1367, 1380},	{1338, 1365},	{1310, 1337},	{1295, 1308}},	// Champ 2
	{{1267, 1280},	{1238, 1265},	{1210, 1237},	{1195, 1208}},	// Champ 1
	{{1167, 1180},	{1138, 1165},	{1110, 1137},	{1095, 1108}},	// Diamond 3
	{{1072, 1080},	{1048, 1071},	{1024, 1047},	{1013, 1023}},	// Diamond 2
	{{992, 1000},	{968, 991},		{944, 967},		{934, 943}},	// Diamond 1
	{{912, 920},	{888, 911},		{864, 887},		{852, 863}},	// Platinum 3
	{{832, 840},	{808, 831},		{784, 807},		{772, 783}},	// Platinum 2
	{{752, 761},	{728, 751},		{704, 727},		{695, 703}},	// Platinum 1
	{{672, 681},	{648, 671},		{624, 647},		{613, 623}},	// Gold 3
	{{597, 605},	{578, 596},		{559, 577},		{548, 558}},	// Gold 2
	{{537, 545},	{518, 536},		{499, 517},		{490, 498}},	// Gold 1
	{{477, 484},	{458, 476},		{439, 457},		{430, 438}},	// Silver 3
	{{417, 425},	{398, 416},		{379, 397},		{370, 378}},	// Silver 2
	{{357, 365},	{338, 356},		{319, 337},		{310, 318}},	// Silver 1
	{{297, 302},	{278, 296},		{259, 277},		{250, 258}},	// Bronze 3
	{{237, 243},	{218, 236},		{199, 217},		{189, 198}},	// Bronze 2
	{{172, 180},	{155, 170},		{125, 147},		{0, 123}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int solo[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1287, 1319},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1272, 1294},	{1248, 1264},	{1224, 1237},	{1211, 1223}},	// Champ 3
	{{1192, 1201},	{1168, 1188},	{1145, 1165},	{1133, 1143}},	// Champ 2
	{{1112, 1123},	{1088, 1110},	{1064, 1087},	{1055, 1063}},	// Champ 1
	{{1032, 1041},	{1008, 1030},	{984, 1007},	{973, 983}},	// Diamond 3
	{{952, 962},	{928, 951},		{904, 927},		{895, 903}},	// Diamond 2
	{{872, 881},	{848, 871},		{824, 847},		{815, 823}},	// Diamond 1
	{{797, 802},	{778, 796},		{759, 777},		{750, 758}},	// Platinum 3
	{{737, 744},	{718, 736},		{699, 717},		{689, 698}},	// Platinum 2
	{{677, 683},	{658, 676},		{639, 657},		{633, 638}},	// Platinum 1
	{{617, 625},	{598, 616},		{579, 597},		{570, 578}},	// Gold 3
	{{557, 563},	{538, 556},		{519, 537},		{511, 518}},	// Gold 2
	{{497, 506},	{478, 496},		{459, 477},		{453, 458}},	// Gold 1
	{{437, 445},	{418, 436},		{399, 417},		{392, 398}},	// Silver 3
	{{377, 386},	{358, 376},		{339, 357},		{330, 338}},	// Silver 2
	{{317, 323},	{298, 316},		{279, 297},		{270, 278}},	// Silver 1
	{{257, 270},	{238, 255},		{220, 237},		{211, 218}},	// Bronze 3
	{{197, 210},	{178, 195},		{160, 177},		{151, 158}},	// Bronze 2
	{{142, 154},	{133, 140},		{115, 127},		{0, 113}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int hoops[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1242, 1322},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1232, 1242},	{1208, 1225},	{1185, 1207},	{1167, 1183}},	// Champ 3
	{{1152, 1160},	{1128, 1150},	{1105, 1127},	{1089, 1103}},	// Champ 2
	{{1072, 1081},	{1048, 1071},	{1024, 1047},	{1015, 1023}},	// Champ 1
	{{992, 1000},	{968, 991},		{944, 967},		{930, 943}},	// Diamond 3
	{{917, 923},	{898, 916},		{879, 897},		{868, 878}},	// Diamond 2
	{{857, 862},	{838, 856},		{819, 837},		{813, 818}},	// Diamond 1
	{{797, 803},	{778, 796},		{759, 777},		{747, 758}},	// Platinum 3
	{{737, 743},	{718, 736},		{699, 717},		{689, 698}},	// Platinum 2
	{{677, 681},	{658, 676},		{639, 657},		{633, 638}},	// Platinum 1
	{{617, 622},	{598, 616},		{579, 597},		{572, 578}},	// Gold 3
	{{557, 563},	{538, 556},		{519, 537},		{510, 518}},	// Gold 2
	{{497, 504},	{478, 496},		{459, 477},		{451, 458}},	// Gold 1
	{{437, 447},	{418, 436},		{399, 417},		{383, 398}},	// Silver 3
	{{377, 380},	{358, 376},		{339, 357},		{321, 338}},	// Silver 2
	{{317, 327},	{301, 316},		{281, 297},		{266, 277}},	// Silver 1
	{{258, 274},	{238, 256},		{219, 228},		{211, 213}},	// Bronze 3
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 2
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int rumble[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1241, 1330},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1232, 1242},	{1208, 1227},	{1185, 1207},	{1170, 1183}},	// Champ 3
	{{1152, 1160},	{1128, 1150},	{1105, 1127},	{1093, 1103}},	// Champ 2
	{{1072, 1080},	{1048, 1071},	{1024, 1047},	{1015, 1023}},	// Champ 1
	{{992, 1000},	{968, 991},		{944, 967},		{933, 943}},	// Diamond 3
	{{917, 923},	{898, 916},		{879, 897},		{870, 878}},	// Diamond 2
	{{857, 864},	{838, 856},		{819, 837},		{809, 818}},	// Diamond 1
	{{797, 803},	{778, 796},		{759, 777},		{748, 758}},	// Platinum 3
	{{737, 744},	{718, 736},		{699, 717},		{691, 698}},	// Platinum 2
	{{677, 685},	{658, 676},		{639, 657},		{630, 638}},	// Platinum 1
	{{617, 623},	{598, 616},		{579, 597},		{571, 578}},	// Gold 3
	{{557, 560},	{538, 556},		{519, 537},		{511, 518}},	// Gold 2
	{{497, 504},	{478, 496},		{459, 477},		{449, 458}},	// Gold 1
	{{437, 441},	{418, 436},		{399, 417},		{388, 398}},	// Silver 3
	{{377, 385},	{358, 376},		{340, 357},		{328, 338}},	// Silver 2
	{{317, 325},	{298, 315},		{280, 297},		{266, 278}},	// Silver 1
	{{257, 267},	{238, 255},		{225, 237},		{206, 218}},	// Bronze 3
	{{197, 200},	{178, 196},		{164, 177},		{153, 157}},	// Bronze 2
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int dropshot[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1244, 1298},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1232, 1250},	{1208, 1230},	{1185, 1204},	{1166, 1183}},	// Champ 3
	{{1152, 1162},	{1128, 1149},	{1105, 1124},	{1094, 1103}},	// Champ 2
	{{1072, 1080},	{1048, 1070},	{1024, 1047},	{1015, 1023}},	// Champ 1
	{{992, 1002},	{968, 991},		{944, 967},		{935, 943}},	// Diamond 3
	{{917, 925},	{898, 916},		{879, 897},		{873, 878}},	// Diamond 2
	{{857, 862},	{838, 856},		{819, 837},		{811, 818}},	// Diamond 1
	{{797, 805},	{778, 796},		{759, 777},		{749, 758}},	// Platinum 3
	{{737, 742},	{718, 736},		{699, 717},		{692, 698}},	// Platinum 2
	{{677, 682},	{658, 676},		{639, 657},		{630, 638}},	// Platinum 1
	{{617, 621},	{598, 616},		{579, 597},		{573, 578}},	// Gold 3
	{{557, 562},	{538, 556},		{519, 537},		{512, 518}},	// Gold 2
	{{497, 502},	{478, 496},		{459, 477},		{454, 458}},	// Gold 1
	{{437, 443},	{418, 436},		{399, 417},		{385, 398}},	// Silver 3
	{{377, 388},	{358, 376},		{339, 357},		{323, 338}},	// Silver 2
	{{317, 329},	{299, 316},		{279, 297},		{268, 278}},	// Silver 1
	{{257, 272},	{238, 255},		{220, 237},		{203, 218}},	// Bronze 3
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 2
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};

const int snowday[20][4][2] =
{
	//Div 4			Div 3			Div 2			Div 1
	{{1241, 1312},	{-1, -1},		{-1, -1},		{-1, -1}},		// Grand Champ
	{{1232, 1240},	{1208, 1227},	{1185, 1205},	{1165, 1183}},	// Champ 3
	{{1152, 1163},	{1128, 1150},	{1105, 1127},	{1091, 1103}},	// Champ 2
	{{1072, 1080},	{1048, 1071},	{1024, 1047},	{1015, 1023}},	// Champ 1
	{{992, 1000},	{968, 991},		{944, 967},		{935, 943}},	// Diamond 3
	{{917, 926},	{898, 916},		{879, 897},		{869, 878}},	// Diamond 2
	{{857, 863},	{838, 856},		{819, 837},		{811, 818}},	// Diamond 1
	{{797, 805},	{778, 796},		{759, 777},		{747, 758}},	// Platinum 3
	{{737, 743},	{718, 736},		{699, 717},		{688, 698}},	// Platinum 2
	{{677, 685},	{658, 676},		{639, 657},		{634, 638}},	// Platinum 1
	{{617, 622},	{598, 616},		{579, 597},		{566, 578}},	// Gold 3
	{{557, 573},	{538, 556},		{519, 537},		{505, 518}},	// Gold 2
	{{497, 508},	{478, 496},		{459, 477},		{446, 458}},	// Gold 1
	{{437, 447},	{418, 436},		{400, 417},		{384, 398}},	// Silver 3
	{{377, 388},	{358, 375},		{341, 357},		{327, 338}},	// Silver 2
	{{317, 332},	{301, 314},		{282, 297},		{266, 277}},	// Silver 1
	{{257, 263},	{238, 251},		{219, 235},		{211, 217}},	// Bronze 3
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 2
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}},		// Bronze 1
	{{-1, -1},		{-1, -1},		{-1, -1},		{-1, -1}}		// Unranked
};
